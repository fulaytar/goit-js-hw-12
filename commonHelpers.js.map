{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js"],"sourcesContent":["\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst keyApi = '42512842-e518c28c0b42a0fb4c46a85d3';\n\nexport async function imageSearch(query, pageNum) {\nconst queryParams = new URLSearchParams({\n    key: keyApi,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: false,\n    per_page: 15,\n    page: pageNum,\n});\n\n    const response = await axios.get('', { params: queryParams });\nreturn response.data;\n}","// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n//імпорт функці з другого файлу\nimport { imageSearch } from './pixabay-api'\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector('#form');\nconst loader = document.querySelector('div');\nconst gallery = document.querySelector('.gallery');\nconst btnMoreImages = document.querySelector('.load-more');\nconst btnMoreImages_loader = document.querySelector('span.load')\n\nlet pageNum;\nlet currentQuery;\nlet renderCount = 0;\n\n//використовую бібліотеку\nconst lightbox = new SimpleLightbox('.gallery>.item-gallery a', {\n        //* options */\n        backgroundColor: '#EF4040',\n        captionsData: `alt`,\n        captionDelay: 250,\n});\n      \n//навішую подію\nform.addEventListener(\"submit\", searchImages);\n\n\n\n//функція яка відмальовує сторінку\nfunction addImagesMarcup(largeImageURL, webformatURL, tags, likes, views, comments, downloads) {\n  let markupItem= `\n  <li class=\"item-gallery\">\n    <a class=\"load-link\" href=\"${largeImageURL}\">\n      <img class=\"load-image\" src=\"${webformatURL}\" width=\"360\" alt=\"${tags}\" title=\"${tags}\">\n    </a>\n    <ul class=\"load-list\">\n      <li>\n        <h2>Likes</h2>\n        <p>${likes}</p>\n      </li>\n      <li>\n        <h2>Views</h2>\n        <p>${views}</p>\n      </li>\n      <li>\n        <h2>Comments</h2>\n        <p>${comments}</p>\n      </li>\n      <li>\n        <h2>Downloads</h2>\n        <p>${downloads}</p>\n      </li>\n    </ul>\n  </li>\n`;\n    gallery.insertAdjacentHTML('beforeend', markupItem);\n    \n    //scrolling\n  if (renderCount >= 1) {\n    // get height of 1 card\n    const galleryItemHeight = document\n      .querySelector('.item-gallery')\n      .getBoundingClientRect().height;\n    // smooth scrolling on height*2\n    window.scrollBy({ top: galleryItemHeight * 2, behavior: 'smooth' });\n    }\n}\n\n\n//обробка кліка\nfunction searchImages(event) {\n    event.preventDefault();\n    //тут очищаю перед заповненням\n    gallery.innerHTML = '';\n    \n\n\n  //зберігаю значення інпута\n  currentQuery = form.elements.input.value.trim();\n\n  //очистка інпута\n  form.elements.input.value = \"\";\n\n  //перевірка інпута\n  if (currentQuery === \"\") {\n    iziToast.error({\n    title: 'Error',\n    message: `Please enter a search query.`,\n    backgroundColor: '#EF4040',\n    messageColor: '#fff',\n    titleColor: '#fff',\n    progressBarColor: '#B51B1B',\n    position: 'topRight',\n    })\n      \n    return;\n    }\n    \n\n    //якщо повторний запит після помилки - закрив кнопку\n    btnMoreImages.classList.add('is-hidden')\n    \n  //включаю лоадер\n    loader.classList.add('spinner');\n    //тут перша сторінка\n    pageNum = 1;\n    //пішла обробка\n    imageSearch(currentQuery,pageNum).then(response => {\n        if(response.hits.length === 0){\n            iziToast.error({\n    title: 'Error',\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n            });\n            throw new Error('No images found');\n    }\n      //відмальовую\n        response.hits.map(item => addImagesMarcup(item.largeImageURL, item.webformatURL, item.tags, item.likes, item.views, item.comments, item.downloads));\n        //включаю кнопку\n        btnMoreImages.classList.remove('is-hidden')\n      //метод рефреш\n        lightbox.refresh();\n        //коли пошук був успішним\n        renderCount++;\n\n    }).catch(error => console.log(error)).finally(() => {\n        loader.classList.remove('spinner');\n    })\n}\n\nbtnMoreImages.addEventListener(\"click\", addMoreImages);\n\nasync function addMoreImages() {\n    //збільшую сторінку\n    pageNum++;\n    \n    try {\n        btnMoreImages_loader.classList.remove('is-hidden');\n        const response = await imageSearch(currentQuery, pageNum);\n        //відмальовую\n        response.hits.map(item => addImagesMarcup(item.largeImageURL, item.webformatURL, item.tags, item.likes, item.views, item.comments, item.downloads))\n        //метод рефреш\n        lightbox.refresh();\n        \n        //рахую тотал \n        const totalHits = response.totalHits || 0;\n        const totalPages = Math.ceil(totalHits / 15); // Розраховуємо загальну кількість сторінок\n        \n        //виключаю лоадер\n        btnMoreImages_loader.classList.add('is-hidden');\n        if (pageNum >= totalPages) {\n      btnMoreImages.classList.add('is-hidden'); // Ховаємо кнопку \"Load More\", якщо це остання сторінка\n      iziToast.info({\n        title: 'Info',\n        message: `We're sorry, but you've reached the end of search results.`,\n        backgroundColor: '#4CAF50',\n        messageColor: '#fff',\n        titleColor: '#fff',\n        progressBarColor: '#4CAF50',\n        position: 'topRight',\n      });\n    }\n    }\n    catch(error) {\n         iziToast.error({\n      title: 'Error',\n      message: `${error.message || 'Something went wrong'}`,\n      backgroundColor: '#EF4040',\n      messageColor: '#fff',\n      titleColor: '#fff',\n      progressBarColor: '#B51B1B',\n      position: 'topRight',\n    });\n    }}\n"],"names":["axios","keyApi","imageSearch","query","pageNum","queryParams","form","loader","gallery","btnMoreImages","btnMoreImages_loader","currentQuery","renderCount","lightbox","SimpleLightbox","searchImages","addImagesMarcup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","markupItem","galleryItemHeight","event","iziToast","response","item","error","addMoreImages","totalHits","totalPages"],"mappings":"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"}